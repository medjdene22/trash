import{j as e,c as h,r as w,z as I,e as x,E as k,D}from"./index-Bazt0cBE.js";import{d as A,M as C,C as M,P,u as T,N as F,H as R,c as N}from"./NoInternet-DpxRTM5E.js";import{I as $,C as z,a as E}from"./image-GMA0gPG2.js";const L=({date:a,className:t,vr:s})=>{const n=new Date(a),c=new Date,r=(n.getTime()-c.getTime())/1e3-3600,d=new Intl.RelativeTimeFormat(s,{numeric:"auto"});let l,i;const o=Math.abs(r);return o<60?(l=Math.round(r),i="second"):o<3600?(l=Math.round(r/60),i="minute"):o<86400?(l=Math.round(r/3600),i="hour"):o<2592e3?(l=Math.round(r/86400),i="day"):o<31536e3?(l=Math.round(r/2592e3),i="month"):(l=Math.round(r/31536e3),i="year"),e.jsx("time",{dateTime:a,className:t,children:d.format(l,i).replace(/^قبل\s/,"منذ ")})},S=({className:a,meta:t,vr:s})=>{const{date:n}=t;return e.jsx("div",{className:h("post-card-meta flex flex-wrap items-center text-xs/6",a),children:e.jsx("span",{className:"font-normal text-neutral-500 dark:text-neutral-400",children:e.jsx(L,{date:n,vr:s})})})},q=({className:a,post:t,vr:s})=>{const{title:n,handle:c,featuredImage:r,excerpt:d,categories:l,postType:i,id:o,videoUrl:m,short_link:u}=t,p=s==="fr"?"/news/fr/$postId":"/news/$postId",j=decodeURIComponent(c),[f,g]=w.useState(!1),y=w.useRef(null),b=I(),v=!!r.src&&!r.src.includes("placehold")&&!r.src.includes("/default-");return e.jsxs("div",{ref:y,className:h("group post-card-3 flex flex-wrap items-center gap-x-7 gap-y-5 sm:flex-nowrap ",a),children:[e.jsxs("div",{className:h("overflow-hidden relative aspect-16/9 sm:aspect-1/1 w-full  sm:w-56 shrink-0 rounded-2xl shadow-lg transition-shadow shadow-black/30",!v&&"hidden sm:block"),children:[e.jsx($,{src:r,alt:n,className:"w-full rounded-2xl  object-cover brightness-100 transition-[filter] duration-300 group-hover:brightness-75",fill:!0}),!f&&m&&e.jsx(A,{onClick:()=>g(!f),className:"absolute z-30 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 hover:bg-accent-foreground rounded-full cursor-pointer",postType:i,wrapSize:"size-12",iconSize:"size-7"}),m&&e.jsx(C,{setIsHover:()=>g(!f),isHover:f,videoUrl:m,handle:c,vr:s}),e.jsx(x,{"aria-label":t.title,to:p,params:{postId:j},search:{id:o},...!b&&{target:"_blank"},className:"absolute inset-0"})]}),e.jsxs("div",{className:"flex grow flex-col",children:[e.jsxs("div",{className:"space-y-3.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{categories:l,vr:s}),e.jsx(P,{handle:u,className:"ms-auto",vr:s},o)]}),e.jsx("h2",{className:"nc-card-title block text-base font-medium sm:font-semibold xl:text-lg",children:e.jsx(x,{"aria-label":t.title,to:p,params:{postId:j},search:{id:o},className:"line-clamp-2",title:n,dangerouslySetInnerHTML:{__html:n}})}),e.jsx("p",{className:"line-clamp-3 text-sm/6 text-neutral-600 dark:text-neutral-400",children:d})]}),e.jsx("div",{className:"py-1",children:e.jsx(S,{meta:t,vr:s})})]})]})},O=({posts:a,heading:t,vr:s,loading:n,linkto:c})=>{const r=(m,u)=>e.jsx(q,{className:"py-1",post:m,vr:s},u),{isOnline:d,checkConnection:l}=T(),i=s==="fr"?"/news/fr/$postId":"/news/$postId",o=c??(s==="fr"?"dernieres-actualites":decodeURIComponent("%D8%A2%D8%AE%D8%B1-%D8%A7%D9%84%D8%A3%D8%AE%D8%A8%D8%A7%D8%B1"));return n?e.jsxs("div",{className:"pt-4",children:[" ",e.jsx("div",{className:"space-y-6 lg:col-span-2",children:Array.from({length:8}).map((m,u)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-50 w-56 rounded-lg bg-gray-300"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),e.jsx("div",{className:"h-4 w-full rounded bg-gray-200"})]})]},u))})]}):a.length==0?(l(),e.jsx("div",{className:"w-full lg:w-3/5 xl:w-2/3 xl:pe-20 mx-auto",children:!d&&e.jsx(F,{isFr:s==="fr",isOnline:d,onRetry:()=>window.location.reload(),checkConnection:l})})):e.jsxs("div",{className:"pt-4",children:[!!t&&e.jsx(R,{level:2,children:e.jsxs(x,{to:i,params:{postId:o},className:"flex items-center space-x-4 ",children:[t,s==="fr"?e.jsx(z,{size:19,strokeWidth:3,className:"mt-1"}):e.jsx(E,{size:19,strokeWidth:3,className:"mt-1"})," "]})}),e.jsx("div",{className:h("grid gap-6 md:gap-7"),children:a.map(r)})]})},B="https://betaapin.fibladi.com/fibladi",G=(a,t,s)=>N({enabled:!!a,staleTime:6e5,queryKey:["cat",{cat:a,page:t,rand:!!s}],queryFn:async()=>{const c=await fetch(`${B}/categorie/${a}?p=${t}`);if(!c.ok)throw new Error("faild to fetch posts");const{results:r,total:d}=await c.json(),l=r.map(o=>k(o));return{posts:s?D(l):l,total:d}}}),H="https://betaapiw.fibladi.com/api/ads/feed",_=async a=>{const t=await fetch(`${H}?limit=${a}`);if(!t.ok)throw new Error("Failed to fetch ads feed");return(await t.json()).map(n=>({id:n.id,title:n.title,image:n.image,link:n.Link}))},Q=a=>N({queryKey:["adsFeed",a],queryFn:()=>_(a),staleTime:1e3*60*20});export{O as L,Q as a,L as b,G as u};
