{"version":3,"file":"index-CRLivcKp.js","sources":["../../src/routes/news/$postId/index.tsx?tsr-split=component"],"sourcesContent":["//todo top cat\n// routes/posts/$postId.tsx\n// import SingleContentContainer from '@/components/single/SingleContentContainer'\n// import SingleHeaderContainer from '@/components/single/SingleHeaderContainer'\nimport { createFileRoute } from '@tanstack/react-router'\n// import SingleRelatedPosts from '@/components/single/SingleRelatedPosts'\n// import Weekly from '@/components/weekly'\nimport PageSkeleton from '@/components/post-skeleton'\nimport {\n  categoriesAr,\n  homeCategoriesAr,\n  categoriesAR,\n  TPostDetail,\n  trendingAr,\n  pages,\n} from '@/types'\nimport CategoryComponent from '@/components/category'\nimport HomeCategory from '@/components/homeCategory'\nimport { getPostByHandle } from '@/data/posts'\nimport TrendingPosts from '@/components/trendingPosts'\nimport LastComponent from '@/components/lastNews'\n// import { useGetTrending } from '@/query/post/getTrendingByTime'\nimport { queryClient } from '@/main'\n// import { useGetPost } from '@/query/post/getPost'\n// import { useGetPostByCat } from '@/query/post/getLastByCategory'\nimport { PostComponent } from '@/components/singlePost'\nimport { getMimeFromFibladi } from '@/lib/utils'\nimport z from 'zod'\n\nconst fetchPost = (lang: 'fr' | 'ar', postSlug: string, id?: number) =>\n  getPostByHandle(postSlug, lang, id).then((res) => res.post)\n\nexport const Route = createFileRoute('/news/$postId/')({\n  validateSearch: z.object({\n    id: z.coerce.number().optional(), // will parse ?p=123 into number 123\n  }),\n  staleTime: 3600000,\n  preloadStaleTime: 3600000,\n  loaderDeps: ({ search: { id } }) => ({ id }),\n  loader: async ({ params: { postId }, deps: { id } }) => {\n    if (!id) {\n      if (trendingAr.has(postId)) {\n        return {\n          postId,\n          post: null,\n          relatedPosts: [],\n          type: 'trending',\n        }\n      } else if (pages.has(postId)) {\n        return {\n          postId,\n          post: null,\n          relatedPosts: [],\n          type: 'page',\n        }\n      } else if (categoriesAr.has(decodeURIComponent(postId))) {\n        return {\n          postId,\n          code: categoriesAr.get(decodeURIComponent(postId))?.code,\n          relatedPosts: [],\n          type: 'category',\n        }\n      } else if (homeCategoriesAr.has(decodeURIComponent(postId))) {\n        return {\n          postId,\n          code: homeCategoriesAr.get(decodeURIComponent(postId))?.code,\n          type: 'categoryHome',\n        }\n      }\n    }\n    const post: TPostDetail = await queryClient.ensureQueryData({\n      queryKey: ['post', { lang: 'ar', postSlug: postId }],\n      staleTime: 10000,\n\n      queryFn: () =>\n        fetchPost('ar', postId, id).then((res) => {\n          return res\n        }),\n    })\n\n    // const { post } = await getPostByHandle(postId, 'ar')\n    // console.log('res', data)\n    // const postsRes = await fetch(\n    //   `https://bladiscra.medjdenimadeddine.workers.dev/posts/${postId}`,\n    // )\n    // const { post, relatedPosts } = await postsRes.json()\n    // if (!post) throw notFound({ routeId: rootRouteId })\n\n    return { postId, post, type: 'post' }\n  },\n  // errorComponent: PageSkeleton,\n  pendingMs: 200,\n  pendingMinMs: 200,\n  pendingComponent: () => {\n    const { postId } = Route.useParams()\n    let type: 'categoryHome' | 'category' | 'post'\n    if (categoriesAr.has(postId) || trendingAr.has(postId)) {\n      type = 'category'\n    } else if (homeCategoriesAr.has(postId)) {\n      type = 'categoryHome'\n    } else {\n      type = 'post'\n    }\n    return <PageSkeleton type={type} />\n  },\n  // notFoundComponent: () => <div>post Not found</div>,\n  // errorComponent: ({ error, reset }) => (\n  //   <div>\n  //     <h2>Error loading post</h2>\n  //     <p>{error.message}</p>\n  //     <button onClick={reset}>Try Again</button>\n  //   </div>\n  // ),\n  component: () => {\n    const { type, postId, post, code } = Route.useLoaderData()\n    if (type === 'trending') {\n      return <TrendingPosts trendingwhen={postId} vr=\"ar\" />\n    } else if (type === 'page') {\n      return <StaticPage name={pages.get(postId)?.nameAr ?? ''} />\n    } else if (type === 'category') {\n      if (!!code && code < 3)\n        return (\n          <LastComponent categoryId={postId} vr=\"ar\" code={code} page=\"1\" />\n        )\n      return (\n        <CategoryComponent\n          categoryId={postId}\n          vr=\"ar\"\n          code={code as number}\n          page=\"1\"\n        />\n      )\n    } else if (type === 'categoryHome') {\n      return <HomeCategory categoryId={postId} vr=\"ar\" code={code as number} />\n    } else if (type === 'post') {\n      // if (!post) throw notFound({ routeId: rootRouteId })\n      return <PostComponent post={post as TPostDetail} vr=\"ar\" />\n    }\n  },\n\n  head: ({ params: { postId }, loaderData }) => {\n    const post = loaderData?.post\n    const type = loaderData?.type\n    const isPost = type === 'post' && !!post\n\n    const title: string = isPost\n      ? post.title\n      : pages.has(postId)\n        ? pages.get(postId)?.nameFr || 'page'\n        : categoriesAR.get(postId)?.name || 'categoriy'\n\n    const description = isPost ? post.excerpt : categoriesAR.get(postId)?.name\n    const keywords = isPost\n      ? post.title\n          .split(' ')\n          .slice(0, 9)\n          .concat(post.categories[0].name)\n          .join(', ')\n      : categoriesAR.get(postId)?.name\n\n    return {\n      meta: [\n        { name: 'description', content: description },\n        { title: title },\n\n        { name: 'keywords', content: keywords },\n\n        { property: 'og:locale', content: 'ar_AR' },\n        { property: 'og:type', content: 'article' },\n        {\n          property: 'og:title',\n          content: title,\n        },\n        {\n          property: 'og:description',\n          content: isPost ? post.excerpt : categoriesAR.get(postId)?.name,\n        },\n        {\n          property: 'og:url',\n          content: 'https://fibladi.com/news/' + postId,\n        },\n        { property: 'og:site_name', content: 'fibladi' },\n        {\n          property: 'article:published_time',\n          content: isPost ? post.date : '2025-09-09T14:42:20+00:00',\n        },\n        {\n          property: 'og:image',\n          content: isPost\n            ? post.featuredImage.src\n            : 'https://fibladi.com/news/fr/wp-content/uploads/sites/2/2019/10/default-390x260-1.jpg',\n        },\n        { property: 'og:image:width', content: '895' },\n        { property: 'og:image:height', content: '576' },\n        {\n          property: 'og:image:type',\n          content: getMimeFromFibladi(post?.featuredImage.src),\n        },\n\n        {\n          property: 'twitter:card',\n          content: 'summary',\n        },\n        {\n          property: 'twitter:creator',\n          content: '@fibladi',\n        },\n        {\n          property: 'twitter:site',\n          content: '@fibladi',\n        },\n        {\n          property: 'twitter:title',\n          content: title,\n        },\n        {\n          property: 'twitter:description',\n          content: isPost ? post.excerpt : categoriesAR.get(postId)?.name,\n        },\n        // You can add more meta or override\n      ],\n      links: [\n        {\n          rel: 'canonical',\n          href: 'https://fibladi.com/news/' + postId,\n        },\n      ],\n    }\n  },\n})\n\nfunction StaticPage({ name }: { name: string }) {\n  return (\n    <div className=\"container min-h-52 flex items-center justify-center text-3xl font-bold\">\n      {name}\n    </div>\n  )\n}\n"],"names":["StaticPage","name","jsx","SplitComponent","type","postId","post","code","Route","useLoaderData","TrendingPosts","pages","get","nameAr","LastComponent","CategoryComponent","HomeCategory","PostComponent"],"mappings":"8sBAuOA,SAASA,EAAW,CAAEC,KAAAA,CAAuB,EAAG,CAC9C,OACEC,EAAAA,IAAC,MAAA,CAAI,UAAU,yEACZD,SAAAA,EACH,CAEJ,CAAC,MAAAE,EA5HYA,IAAM,OACf,KAAM,CAAEC,KAAAA,EAAMC,OAAAA,EAAQC,KAAAA,EAAMC,KAAAA,CAAAA,EAASC,EAAMC,cAAAA,EAC3C,GAAIL,IAAS,WACX,OAAOF,EAAAA,IAACQ,EAAA,CAAc,aAAcL,EAAQ,GAAG,KAAI,EACrD,GAAWD,IAAS,OAClB,OAAOF,EAAAA,IAACF,GAAW,OAAMW,EAAAA,EAAMC,IAAIP,CAAM,IAAhBM,YAAAA,EAAmBE,SAAU,GAAG,EAC3D,GAAWT,IAAS,WAClB,OAAMG,GAAQA,EAAO,EAEjBL,EAAAA,IAACY,EAAA,CAAc,WAAYT,EAAQ,GAAG,KAAK,KAAAE,EAAY,KAAK,IAAG,EAGjEL,MAACa,GACC,WAAYV,EACZ,GAAG,KACH,KAAAE,EACA,KAAK,IAAG,EAGd,GAAWH,IAAS,eAClB,aAAQY,EAAA,CAAa,WAAYX,EAAQ,GAAG,KAAK,KAAAE,EAAqB,EACxE,GAAWH,IAAS,OAElB,OAAOF,EAAAA,IAACe,EAAA,CAAc,KAAAX,EAA2B,GAAG,IAAA,CAAI,CAE5D"}