import{j as e,c as h,r as w,z as b,e as p,E as I,D as k}from"./index-BMd-jbT0.js";import{d as D,M as C,C as M,P as A,u as P,N as R,H as T,c as z}from"./NoInternet-eXLd3SC-.js";import{I as L,C as $,a as E}from"./image-DES5a_om.js";const H=({date:r,className:l,vr:s})=>{const c=new Date(r),i=new Date,a=(c.getTime()-i.getTime())/1e3-3600,d=new Intl.RelativeTimeFormat(s,{numeric:"auto"});let t,o;const n=Math.abs(a);return n<60?(t=Math.round(a),o="second"):n<3600?(t=Math.round(a/60),o="minute"):n<86400?(t=Math.round(a/3600),o="hour"):n<2592e3?(t=Math.round(a/86400),o="day"):n<31536e3?(t=Math.round(a/2592e3),o="month"):(t=Math.round(a/31536e3),o="year"),e.jsx("time",{dateTime:r,className:l,children:d.format(t,o).replace(/^قبل\s/,"منذ ")})},S=({className:r,meta:l,vr:s})=>{const{date:c}=l;return e.jsx("div",{className:h("post-card-meta flex flex-wrap items-center text-xs/6",r),children:e.jsx("span",{className:"font-normal text-neutral-500 dark:text-neutral-400",children:e.jsx(H,{date:c,vr:s})})})},B=({className:r,post:l,vr:s})=>{const{title:c,handle:i,featuredImage:a,excerpt:d,categories:t,postType:o,id:n,videoUrl:m,short_link:u}=l,f=s==="fr"?"/news/fr/$postId":"/news/$postId",j=decodeURIComponent(i),[x,g]=w.useState(!1),N=w.useRef(null),y=b(),v=!!a.src&&!a.src.includes("placehold")&&!a.src.includes("/default-");return e.jsxs("div",{ref:N,className:h("group post-card-3 flex flex-wrap items-center gap-x-7 gap-y-5 sm:flex-nowrap ",r),children:[e.jsxs("div",{className:h("overflow-hidden relative aspect-16/9 sm:aspect-1/1 w-full  sm:w-56 shrink-0 rounded-2xl shadow-lg transition-shadow shadow-black/30",!v&&"hidden sm:block"),children:[e.jsx(L,{src:a,alt:c,className:"w-full rounded-2xl  object-cover brightness-100 transition-[filter] duration-300 group-hover:brightness-75",fill:!0}),!x&&m&&e.jsx(D,{onClick:()=>g(!x),className:"absolute z-30 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 hover:bg-accent-foreground rounded-full cursor-pointer",postType:o,wrapSize:"size-12",iconSize:"size-7"}),m&&e.jsx(C,{setIsHover:()=>g(!x),isHover:x,videoUrl:m,handle:i,vr:s}),e.jsx(p,{to:f,params:{postId:j},search:{id:n},...!y&&{target:"_blank"},className:"absolute inset-0"})]}),e.jsxs("div",{className:"flex grow flex-col",children:[e.jsxs("div",{className:"space-y-3.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{categories:t,vr:s}),e.jsx(A,{handle:u,className:"ms-auto",vr:s},n)]}),e.jsx("h2",{className:"nc-card-title block text-base font-medium sm:font-semibold xl:text-lg",children:e.jsx(p,{to:f,params:{postId:j},search:{id:n},className:"line-clamp-2",title:c,dangerouslySetInnerHTML:{__html:c}})}),e.jsx("p",{className:"line-clamp-3 text-sm/6 text-neutral-600 dark:text-neutral-400",children:d})]}),e.jsx("div",{className:"py-1",children:e.jsx(S,{meta:l,vr:s})})]})]})},U=({posts:r,heading:l,vr:s,loading:c,linkto:i})=>{const a=(m,u)=>e.jsx(B,{className:"py-1",post:m,vr:s},u),{isOnline:d,checkConnection:t}=P(),o=s==="fr"?"/news/fr/$postId":"/news/$postId",n=i??(s==="fr"?"dernieres-actualites":decodeURIComponent("%D8%A2%D8%AE%D8%B1-%D8%A7%D9%84%D8%A3%D8%AE%D8%A8%D8%A7%D8%B1"));return c?e.jsxs("div",{className:"pt-4",children:[" ",e.jsx("div",{className:"space-y-6 lg:col-span-2",children:Array.from({length:8}).map((m,u)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-50 w-56 rounded-lg bg-gray-300"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),e.jsx("div",{className:"h-4 w-full rounded bg-gray-200"})]})]},u))})]}):r.length==0?(t(),e.jsx("div",{className:"w-full lg:w-3/5 xl:w-2/3 xl:pe-20 mx-auto",children:!d&&e.jsx(R,{isFr:s==="fr",isOnline:d,onRetry:()=>window.location.reload(),checkConnection:t})})):e.jsxs("div",{className:"pt-4",children:[!!l&&e.jsx(T,{level:2,children:e.jsxs(p,{to:o,params:{postId:n},className:"flex items-center space-x-4 ",children:[l,s==="fr"?e.jsx($,{size:19,strokeWidth:3,className:"mt-1"}):e.jsx(E,{size:19,strokeWidth:3,className:"mt-1"})," "]})}),e.jsx("div",{className:h("grid gap-6 md:gap-7"),children:r.map(a)})]})},W="https://apin.fibladi.com/fibladi",O=(r,l,s)=>z({enabled:!!r,staleTime:6e5,queryKey:["cat",{cat:r,page:l,rand:!!s}],queryFn:async()=>{const i=await fetch(`${W}/categorie/${r}?p=${l}`);if(!i.ok)throw new Error("faild to fetch posts");const{results:a,total:d}=await i.json(),t=a.map(n=>I(n));return{posts:s?k(t):t,total:d}}});export{U as L,H as a,O as u};
