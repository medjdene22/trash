{"version":3,"file":"lastCatHome-CaSGVV2C.js","sources":["../../src/query/post/getTop.ts","../../src/components/lastCatHome.tsx"],"sourcesContent":["import { shuffle } from '@/config'\nimport { originToUsable, TUnPost } from '@/data/posts'\nimport { TPost } from '@/types'\nimport { useQuery } from '@tanstack/react-query'\n\nconst api = import.meta.env.VITE_API_NEWS\n\nexport const useGetTopPost = (cat: string, page: string = '1') => {\n  const query = useQuery({\n    enabled: !!cat,\n    staleTime: 1000 * 60 * 10,\n    queryKey: ['top', { cat, page }],\n    queryFn: async () => {\n      const response = await fetch(`${api}/bestnews/${cat}?p=${page}`)\n      if (!response.ok) {\n        throw new Error('faild to fetch posts')\n      }\n\n      const { results: unformatedPosts, total }: categorieResponse =\n        await response.json()\n\n      // const formatedPosts: TPost[] = unformatedPosts\n      //   .slice(0, 4)\n      //   .map((post) => originToUsable(post, true))\n\n      const randomPosts = shuffle(\n        [unformatedPosts[0], ...shuffle(unformatedPosts.slice(1, 10))].slice(\n          0,\n          4,\n        ),\n      )\n\n      const formatedPosts: TPost[] = randomPosts.map((post) =>\n        originToUsable(post, true),\n      )\n\n      // const posts: TPost[] = shuffle(\n      //   [formatedPosts[0], ...shuffle(formatedPosts.slice(1, 10))].slice(0, 4),\n      // )\n      // console.log(total)\n      return { posts: formatedPosts, total }\n    },\n  })\n  return query\n}\n\nexport interface categorieResponse {\n  page: number\n  pageSize: number\n  total: number\n  results: TUnPost[]\n}\n","import Heading from '@/shared/Heading'\nimport SectionSliderPosts from './PostCards/SectionSliderPosts'\nimport { ChevronRight, ChevronLeft } from 'lucide-react'\nimport { Link } from '@tanstack/react-router'\nimport { useGetPostByCat } from '@/query/post/getLastByCategory'\nimport { homeCategoriesAr, homeCategoriesFR } from '@/types'\n\nconst LastCategoryHome = ({\n  vr,\n  categorySlug,\n}: {\n  vr: 'ar' | 'fr'\n  categorySlug: string\n}) => {\n  const category =\n    vr === 'fr'\n      ? homeCategoriesFR.get(categorySlug)\n      : homeCategoriesAr.get(categorySlug)\n  const { data, isLoading } = useGetPostByCat(category?.code, '1', true)\n  const posts = data?.posts ?? []\n  const path = vr === 'fr' ? '/news/fr/$postId' : '/news/$postId'\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"bg-gray-300 h-7 w-1/2 rounded\"></div>\n        <div className=\"grid grid-cols-1 sm:grid-cols-4 gap-8\">\n          {[1, 2, 3, 4].map((_, index) => (\n            <div>\n              <div\n                key={index}\n                className=\"animate-pulse rounded-3xl overflow-hidden \"\n              >\n                <div className=\"bg-gray-300 h-32 sm:h-44 w-full\"></div>\n              </div>\n\n              <div className=\"py-4 space-y-2\">\n                <div className=\"bg-gray-300 h-5 w-full rounded\"></div>\n                <div className=\"bg-gray-300 h-5 w-5/6 rounded\"></div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n  return (\n    <div className=\"relative mb-0 py-5\">\n      <Heading level={1} className=\"mb-3\">\n        <Link\n          to={path}\n          params={{ postId: categorySlug }}\n          className=\"flex items-center space-x-4 \"\n        >\n          {category?.name}{' '}\n          {vr === 'fr' ? (\n            <ChevronRight size={19} strokeWidth={3} className=\"mt-1\" />\n          ) : (\n            <ChevronLeft size={19} strokeWidth={3} className=\"mt-1\" />\n          )}\n        </Link>\n      </Heading>\n      <SectionSliderPosts\n        posts={posts}\n        perView={4}\n        showViewAll\n        viewAllLinkHref={\n          vr === 'fr' ? `/news/fr/${categorySlug}` : `/news/${categorySlug}`\n        }\n        // className=\"overflow-hidden\"\n        vr={vr}\n      />\n    </div>\n  )\n}\n\nexport default LastCategoryHome\n"],"names":["api","useGetTopPost","cat","page","useQuery","response","unformatedPosts","total","shuffle","post","originToUsable","LastCategoryHome","vr","categorySlug","category","homeCategoriesFR","homeCategoriesAr","data","isLoading","useGetPostByCat","posts","path","jsxs","jsx","_","index","Heading","Link","ChevronRight","ChevronLeft","SectionSliderPosts"],"mappings":"2TAKA,MAAMA,EAAM,uCAECC,EAAgB,CAACC,EAAaC,EAAe,MAC1CC,EAAS,CACrB,QAAS,CAAC,CAACF,EACX,UAAW,IACX,SAAU,CAAC,MAAO,CAAE,IAAAA,EAAK,KAAAC,EAAM,EAC/B,QAAS,SAAY,CACnB,MAAME,EAAW,MAAM,MAAM,GAAGL,CAAG,aAAaE,CAAG,MAAMC,CAAI,EAAE,EAC/D,GAAI,CAACE,EAAS,GACZ,MAAM,IAAI,MAAM,sBAAsB,EAGxC,KAAM,CAAE,QAASC,EAAiB,MAAAC,GAChC,MAAMF,EAAS,KAAA,EAqBjB,MAAO,CAAE,MAfWG,EAClB,CAACF,EAAgB,CAAC,EAAG,GAAGE,EAAQF,EAAgB,MAAM,EAAG,EAAE,CAAC,CAAC,EAAE,MAC7D,EACA,CAAA,CACF,EAGyC,IAAKG,GAC9CC,EAAeD,EAAM,EAAI,CAAA,EAOI,MAAAF,CAAA,CACjC,CAAA,CACD,ECnCGI,EAAmB,CAAC,CACxB,GAAAC,EACA,aAAAC,CACF,IAGM,CACJ,MAAMC,EACJF,IAAO,KACHG,EAAiB,IAAIF,CAAY,EACjCG,EAAiB,IAAIH,CAAY,EACjC,CAAE,KAAAI,EAAM,UAAAC,GAAcC,EAAgBL,GAAA,YAAAA,EAAU,KAAM,IAAK,EAAI,EAC/DM,GAAQH,GAAA,YAAAA,EAAM,QAAS,CAAA,EACvBI,EAAOT,IAAO,KAAO,mBAAqB,gBAEhD,OAAIM,EAEAI,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,+BAAA,CAAgC,EAC/CA,EAAAA,IAAC,MAAA,CAAI,UAAU,wCACZ,UAAC,EAAG,EAAG,EAAG,CAAC,EAAE,IAAI,CAACC,EAAGC,WACnB,MAAA,CACC,SAAA,CAAAF,EAAAA,IAAC,MAAA,CAEC,UAAU,6CAEV,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,iCAAA,CAAkC,CAAA,EAH5CE,CAAA,EAMPH,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,gCAAA,CAAiC,EAChDA,EAAAA,IAAC,MAAA,CAAI,UAAU,+BAAA,CAAgC,CAAA,CAAA,CACjD,CAAA,CAAA,CACF,CACD,CAAA,CACH,CAAA,EACF,EAIFD,EAAAA,KAAC,MAAA,CAAI,UAAU,qBACb,SAAA,CAAAC,EAAAA,IAACG,EAAA,CAAQ,MAAO,EAAG,UAAU,OAC3B,SAAAJ,EAAAA,KAACK,EAAA,CACC,GAAIN,EACJ,OAAQ,CAAE,OAAQR,CAAA,EAClB,UAAU,+BAET,SAAA,CAAAC,GAAA,YAAAA,EAAU,KAAM,IAChBF,IAAO,KACNW,EAAAA,IAACK,GAAa,KAAM,GAAI,YAAa,EAAG,UAAU,MAAA,CAAO,QAExDC,EAAA,CAAY,KAAM,GAAI,YAAa,EAAG,UAAU,MAAA,CAAO,CAAA,CAAA,CAAA,EAG9D,EACAN,EAAAA,IAACO,EAAA,CACC,MAAAV,EACA,QAAS,EACT,YAAW,GACX,gBACER,IAAO,KAAO,YAAYC,CAAY,GAAK,SAASA,CAAY,GAGlE,GAAAD,CAAA,CAAA,CACF,EACF,CAEJ"}