import{j as e,c as h,r as w,z as I,e as p,E as k,D}from"./index-Ta-mg3OE.js";import{d as A,M as C,C as M,P,u as T,N as $,H as R,c as b}from"./NoInternet-DFULPTrw.js";import{I as E,C as F,a as L}from"./image-B2KkzW4R.js";const z=({date:s,className:a,vr:t})=>{const n=new Date(s),c=new Date,r=(n.getTime()-c.getTime())/1e3-3600,d=new Intl.RelativeTimeFormat(t,{numeric:"auto"});let o,i;const l=Math.abs(r);return l<60?(o=Math.round(r),i="second"):l<3600?(o=Math.round(r/60),i="minute"):l<86400?(o=Math.round(r/3600),i="hour"):l<2592e3?(o=Math.round(r/86400),i="day"):l<31536e3?(o=Math.round(r/2592e3),i="month"):(o=Math.round(r/31536e3),i="year"),e.jsx("time",{dateTime:s,className:a,children:d.format(o,i).replace(/^قبل\s/,"منذ ")})},S=({className:s,meta:a,vr:t})=>{const{date:n}=a;return e.jsx("div",{className:h("post-card-meta flex flex-wrap items-center text-xs/6",s),children:e.jsx("span",{className:"font-normal text-neutral-500 dark:text-neutral-400",children:e.jsx(z,{date:n,vr:t})})})},q=({className:s,post:a,vr:t})=>{const{title:n,handle:c,featuredImage:r,excerpt:d,categories:o,postType:i,id:l,videoUrl:m,short_link:u}=a,x=t==="fr"?"/news/fr/$postId":"/news/$postId",g=decodeURIComponent(c),[f,j]=w.useState(!1),y=w.useRef(null),N=I(),v=!!r.src&&!r.src.includes("placehold")&&!r.src.includes("/default-");return e.jsxs("div",{ref:y,className:h("group post-card-3 flex flex-wrap items-center gap-x-7 gap-y-5 sm:flex-nowrap ",s),children:[e.jsxs("div",{className:h("overflow-hidden relative aspect-16/9 sm:aspect-1/1 w-full  sm:w-56 shrink-0 rounded-2xl shadow-lg transition-shadow shadow-black/30",!v&&"hidden sm:block"),children:[e.jsx(E,{src:r,alt:n,className:"w-full rounded-2xl  object-cover brightness-100 transition-[filter] duration-300 group-hover:brightness-75",fill:!0}),!f&&m&&e.jsx(A,{onClick:()=>j(!f),className:"absolute z-30 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 hover:bg-accent-foreground rounded-full cursor-pointer",postType:i,wrapSize:"size-12",iconSize:"size-7"}),m&&e.jsx(C,{setIsHover:()=>j(!f),isHover:f,videoUrl:m,handle:c,vr:t}),e.jsx(p,{"aria-label":a.title,to:x,params:{postId:g},search:{id:l},...!N&&{target:"_blank"},className:"absolute inset-0"})]}),e.jsxs("div",{className:"flex grow flex-col",children:[e.jsxs("div",{className:"space-y-3.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{categories:o,vr:t}),e.jsx(P,{handle:u,className:"ms-auto",vr:t},l)]}),e.jsx("h2",{className:"nc-card-title block text-base font-medium sm:font-semibold xl:text-lg",children:e.jsx(p,{"aria-label":a.title,to:x,params:{postId:g},search:{id:l},className:"line-clamp-2",title:n,dangerouslySetInnerHTML:{__html:n}})}),e.jsx("p",{className:"line-clamp-3 text-sm/6 text-neutral-600 dark:text-neutral-400",children:d})]}),e.jsx("div",{className:"py-1",children:e.jsx(S,{meta:a,vr:t})})]})]})},O=({posts:s,heading:a,vr:t,loading:n,linkto:c})=>{const r=(m,u)=>e.jsx(q,{className:"py-1",post:m,vr:t},u),{isOnline:d,checkConnection:o}=T(),i=t==="fr"?"/news/fr/$postId":"/news/$postId",l=c??(t==="fr"?"dernieres-actualites":decodeURIComponent("%D8%A2%D8%AE%D8%B1-%D8%A7%D9%84%D8%A3%D8%AE%D8%A8%D8%A7%D8%B1"));return n?e.jsxs("div",{className:"pt-4",children:[" ",e.jsx("div",{className:"space-y-6 lg:col-span-2",children:Array.from({length:8}).map((m,u)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-50 w-56 rounded-lg bg-gray-300"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),e.jsx("div",{className:"h-4 w-full rounded bg-gray-200"})]})]},u))})]}):s.length==0?(o(),e.jsx("div",{className:"w-full lg:w-3/5 xl:w-2/3 xl:pe-20 mx-auto",children:!d&&e.jsx($,{isFr:t==="fr",isOnline:d,onRetry:()=>window.location.reload(),checkConnection:o})})):e.jsxs("div",{className:"pt-4",children:[!!a&&e.jsx(R,{level:2,children:e.jsxs(p,{to:i,params:{postId:l},className:"flex items-center space-x-4 ",children:[a,t==="fr"?e.jsx(F,{size:19,strokeWidth:3,className:"mt-1"}):e.jsx(L,{size:19,strokeWidth:3,className:"mt-1"})," "]})}),e.jsx("div",{className:h("grid gap-6 md:gap-7"),children:s.map(r)})]})},B="https://betaapin.fibladi.com/fibladi",G=(s,a,t)=>b({enabled:!!s,staleTime:6e5,queryKey:["cat",{cat:s,page:a,rand:!!t}],queryFn:async()=>{const c=await fetch(`${B}/categorie/${s}?p=${a}`);if(!c.ok)throw new Error("faild to fetch posts");const{results:r,total:d}=await c.json(),o=r.map(l=>k(l));return{posts:t?D(o):o,total:d}}}),H="https://betaapiw.fibladi.com/api/ads/feed",U=async s=>{const a=await fetch(`${H}${s>1?"?limit="+s:""}`);if(!a.ok)throw new Error("Failed to fetch ads feed");return(await a.json()).map(n=>({id:n.id,title:n.title,image:n.image,link:n.LinkToshop,Video:_(n.Video)}))},Q=s=>b({queryKey:["adsFeed",s],queryFn:()=>U(s),staleTime:1e3*60*20});function _(s){return s?s.includes("youtube.com")||s.includes("youtu.be")?`https://www.youtube.com/embed/${s.includes("youtu.be")?s.split("/").pop():new URL(s).searchParams.get("v")}`:s.includes("instagram.com")?`${s.split("?")[0]}embed`:null:null}export{O as L,z as a,Q as b,U as f,G as u};
